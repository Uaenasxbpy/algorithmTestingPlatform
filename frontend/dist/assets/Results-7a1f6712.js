import{a as se,b as ae,_ as le}from"./index-b2730f11.js";import{u as oe}from"./el-empty-211949be.js";/* empty css                  *//* empty css                   */import{V as g,_ as ne,W as ie,O as o,Y as S,P as re,ab as de,ac as ue,ad as ce,av as _e,a0 as me,aw as ve,Z as fe,X as pe,au as ge,$ as ke,a1 as he,aD as ye,a2 as be,ak as xe,aE as Ee,a4 as Ie,aF as ze,a5 as we,aG as Re,aa as Ce,aH as Me}from"./element-plus-53375c2c.js";import{l as Te,h as De,r as A,c as w,j as Ve,q as R,t as a,H as e,B as t,A as x,E as F,m as v,u as k,F as d,G as P,W as $e,C as Be}from"./vendor-05288756.js";const Se={class:"results-container"},Fe={class:"page-header"},Pe={class:"header-actions"},Ne={key:0,class:"results-content"},je={class:"card-header"},Ae={class:"card-header"},Ke={class:"metric-item"},Ye={class:"metric-value"},He={class:"metric-item"},Le={class:"metric-value"},Ue={class:"metric-item"},Oe={class:"metric-value"},Ge={class:"metric-item"},We={class:"metric-value"},qe={class:"metric-item"},Xe={class:"metric-value"},Ze={class:"metric-item"},Je={class:"metric-value"},Qe={class:"metric-item success-rate"},et={class:"metric-value"},tt={class:"size-info"},st={class:"size-value"},at={class:"size-info"},lt={class:"size-value"},ot={class:"size-info"},nt={class:"size-label"},it={class:"size-value"},rt={class:"card-header"},dt={class:"header-actions"},ut={class:"action-buttons"},ct=Te({__name:"Results",setup(_t){const C=se(),E=oe(),N=ae(),n=De({taskId:null}),M=A(1),T=A(20),K=w(()=>C.completedTasks),r=w(()=>n.taskId?C.getTaskById(n.taskId):null),h=w(()=>n.taskId?E.getTaskResults(n.taskId):[]),u=w(()=>n.taskId?E.getTaskMetrics(n.taskId):null),Y=w(()=>{const l=(M.value-1)*T.value,s=l+T.value;return h.value.slice(l,s)}),D=l=>l?S(l).format("YYYY-MM-DD HH:mm:ss"):"N/A",p=l=>l==null?"N/A":l.toFixed(4),$=l=>l?l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:`${(l/(1024*1024)).toFixed(1)} MB`:"N/A",H=()=>{var y,I;if(!((y=r.value)!=null&&y.started_at)||!((I=r.value)!=null&&I.finished_at))return"N/A";const l=S(r.value.started_at),i=S(r.value.finished_at).diff(l,"second");if(i<60)return`${i} 秒`;if(i<3600)return`${Math.floor(i/60)} 分 ${i%60} 秒`;const m=Math.floor(i/3600),f=Math.floor(i%3600/60);return`${m} 小时 ${f} 分`},L=async()=>{if(n.taskId)try{await Promise.all([E.fetchTaskResults(n.taskId),E.fetchTaskPerformanceMetrics(n.taskId)]),M.value=1}catch{g.error("加载任务结果失败")}},U=()=>{if(!h.value.length)return;const s=[["指标名称","数值","单位","测试轮次","创建时间"].join(","),...h.value.map(f=>[f.metric_name,f.value,f.unit||"",f.test_round||"",D(f.created_at)].map(y=>`"${y}"`).join(","))].join(`
`),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a");m.href=URL.createObjectURL(i),m.download=`task_${n.taskId}_results.csv`,m.click(),g.success("结果数据已导出")},O=async()=>{if(n.taskId)try{await N.generateReport(n.taskId,"pdf"),g.success("PDF报告生成成功")}catch{g.error("PDF报告生成失败")}},G=async()=>{if(n.taskId)try{await N.generateReport(n.taskId,"csv"),g.success("CSV报告生成成功")}catch{g.error("CSV报告生成失败")}},W=async()=>{try{await C.fetchTasks({limit:100}),g.success("数据刷新成功")}catch{g.error("数据刷新失败")}};return Ve(()=>{C.fetchTasks({limit:100})}),(l,s)=>{const i=re,m=ne,f=Ce,y=de,I=ue,q=ce,V=ie,b=_e,X=me,j=ve,c=fe,B=pe,Z=ge,z=ke,J=he,Q=ye,ee=Me,te=be;return v(),R("div",Se,[a("div",Fe,[s[3]||(s[3]=a("h2",null,"结果分析",-1)),a("div",Pe,[e(m,{onClick:W},{default:t(()=>[e(i,null,{default:t(()=>[e(k(xe))]),_:1}),s[2]||(s[2]=d(" 刷新 ",-1))]),_:1})])]),e(V,{class:"filter-card"},{default:t(()=>[e(q,{model:n,inline:""},{default:t(()=>[e(I,{label:"选择任务"},{default:t(()=>[e(y,{modelValue:n.taskId,"onUpdate:modelValue":s[0]||(s[0]=_=>n.taskId=_),placeholder:"请选择任务",style:{width:"250px"}},{default:t(()=>[(v(!0),R(P,null,$e(K.value,_=>(v(),x(f,{key:_.id,label:`${_.task_name} (${_.algorithm.name})`,value:_.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(I,null,{default:t(()=>[e(m,{type:"primary",onClick:L,disabled:!n.taskId},{default:t(()=>[...s[4]||(s[4]=[d(" 分析结果 ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])]),_:1}),r.value?(v(),R("div",Ne,[e(V,{class:"task-info-card"},{header:t(()=>[a("div",je,[e(i,null,{default:t(()=>[e(k(Ee))]),_:1}),s[5]||(s[5]=a("span",null,"任务信息",-1))])]),default:t(()=>[e(B,{gutter:16},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(j,{column:1,border:"",size:"small"},{default:t(()=>[e(b,{label:"任务名称"},{default:t(()=>[d(o(r.value.task_name),1)]),_:1}),e(b,{label:"算法名称"},{default:t(()=>[e(X,{type:r.value.algorithm.category==="KEM"?"primary":"success"},{default:t(()=>[d(o(r.value.algorithm.name),1)]),_:1},8,["type"])]),_:1}),e(b,{label:"测试次数"},{default:t(()=>[d(o(r.value.test_count),1)]),_:1})]),_:1})]),_:1}),e(c,{span:12},{default:t(()=>[e(j,{column:1,border:"",size:"small"},{default:t(()=>[e(b,{label:"开始时间"},{default:t(()=>[d(o(D(r.value.started_at)),1)]),_:1}),e(b,{label:"完成时间"},{default:t(()=>[d(o(D(r.value.finished_at)),1)]),_:1}),e(b,{label:"执行时长"},{default:t(()=>[d(o(H()),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u.value?(v(),x(V,{key:0,class:"metrics-card"},{header:t(()=>[a("div",Ae,[e(i,null,{default:t(()=>[e(k(Ie))]),_:1}),s[6]||(s[6]=a("span",null,"性能指标概览",-1))])]),default:t(()=>[e(B,{gutter:16},{default:t(()=>[r.value.algorithm.category==="KEM"?(v(),R(P,{key:0},[e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",Ke,[a("div",Ye,o(p(u.value.avg_keygen_time))+" ms",1),s[7]||(s[7]=a("div",{class:"metric-label"},"平均密钥生成时间",-1))])]),_:1}),e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",He,[a("div",Le,o(p(u.value.avg_encaps_time))+" ms",1),s[8]||(s[8]=a("div",{class:"metric-label"},"平均封装时间",-1))])]),_:1}),e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",Ue,[a("div",Oe,o(p(u.value.avg_decaps_time))+" ms",1),s[9]||(s[9]=a("div",{class:"metric-label"},"平均解封装时间",-1))])]),_:1})],64)):(v(),R(P,{key:1},[e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",Ge,[a("div",We,o(p(u.value.avg_keygen_time))+" ms",1),s[10]||(s[10]=a("div",{class:"metric-label"},"平均密钥生成时间",-1))])]),_:1}),e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",qe,[a("div",Xe,o(p(u.value.avg_sign_time))+" ms",1),s[11]||(s[11]=a("div",{class:"metric-label"},"平均签名时间",-1))])]),_:1}),e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",Ze,[a("div",Je,o(p(u.value.avg_verify_time))+" ms",1),s[12]||(s[12]=a("div",{class:"metric-label"},"平均验证时间",-1))])]),_:1})],64)),e(c,{xs:24,sm:12,lg:6},{default:t(()=>[a("div",Qe,[a("div",et,o(p(u.value.success_rate))+"%",1),s[13]||(s[13]=a("div",{class:"metric-label"},"成功率",-1))])]),_:1})]),_:1}),e(Z),e(B,{gutter:16},{default:t(()=>[e(c,{xs:24,sm:8},{default:t(()=>[a("div",tt,[s[14]||(s[14]=a("div",{class:"size-label"},"公钥大小",-1)),a("div",st,o($(u.value.public_key_size)),1)])]),_:1}),e(c,{xs:24,sm:8},{default:t(()=>[a("div",at,[s[15]||(s[15]=a("div",{class:"size-label"},"私钥大小",-1)),a("div",lt,o($(u.value.private_key_size)),1)])]),_:1}),e(c,{xs:24,sm:8},{default:t(()=>[a("div",ot,[a("div",nt,o(r.value.algorithm.category==="KEM"?"密文大小":"签名大小"),1),a("div",it,o($(r.value.algorithm.category==="KEM"?u.value.ciphertext_size:u.value.signature_size)),1)])]),_:1})]),_:1})]),_:1})):F("",!0),h.value.length>0?(v(),x(V,{key:1},{header:t(()=>[a("div",rt,[e(i,null,{default:t(()=>[e(k(ze))]),_:1}),s[17]||(s[17]=a("span",null,"详细测试结果",-1)),a("div",dt,[e(m,{type:"primary",size:"small",onClick:U},{default:t(()=>[...s[16]||(s[16]=[d(" 导出数据 ",-1)])]),_:1})])])]),default:t(()=>[Be((v(),x(J,{data:Y.value,"max-height":"400"},{default:t(()=>[e(z,{prop:"metric_name",label:"指标名称",width:"150"}),e(z,{prop:"value",label:"数值",width:"120"},{default:t(({row:_})=>[d(o(p(_.value)),1)]),_:1}),e(z,{prop:"unit",label:"单位",width:"80"}),e(z,{prop:"test_round",label:"测试轮次",width:"100"}),e(z,{prop:"created_at",label:"时间",width:"160"},{default:t(({row:_})=>[d(o(D(_.created_at)),1)]),_:1})]),_:1},8,["data"])),[[te,k(E).loading]]),h.value.length>T.value?(v(),x(Q,{key:0,"current-page":M.value,"onUpdate:currentPage":s[1]||(s[1]=_=>M.value=_),"page-size":T.value,total:h.value.length,layout:"total, prev, pager, next",style:{"margin-top":"16px","text-align":"center"}},null,8,["current-page","page-size","total"])):F("",!0)]),_:1})):F("",!0),a("div",ut,[e(m,{type:"success",onClick:O},{default:t(()=>[e(i,null,{default:t(()=>[e(k(we))]),_:1}),s[18]||(s[18]=d(" 生成PDF报告 ",-1))]),_:1}),e(m,{type:"info",onClick:G},{default:t(()=>[e(i,null,{default:t(()=>[e(k(Re))]),_:1}),s[19]||(s[19]=d(" 导出CSV报告 ",-1))]),_:1})])])):(v(),x(ee,{key:1,description:"请选择一个已完成的任务来查看结果分析"}))])}}});const ht=le(ct,[["__scopeId","data-v-52925650"]]);export{ht as default};
//# sourceMappingURL=Results-7a1f6712.js.map
